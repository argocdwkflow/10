Voici la procÃ©dure claire et correcte (niveau production / Satellite 6.17â€“6.18) pour mettre en place des certificats SSL/TLS sur Red Hat Satellite Web UI (HTTPS) et sur les Capsules, avec les bonnes pratiques Red Hat ğŸ”
ğŸ¯ Objectif
AccÃ¨s HTTPS sÃ©curisÃ© au Satellite Web UI
Communication SSL valide Satellite â‡„ Capsules â‡„ Clients
Ã‰viter les certificats auto-signÃ©s non reconnus
ConformitÃ© sÃ©curitÃ© (banque / prod / audit)
ğŸ§± Architecture SSL Red Hat Satellite (rappel)
Satellite = CA interne (par dÃ©faut)
Capsules = certificats signÃ©s par la CA Satellite
Clients = certificats hÃ´te + CA Satellite
Web UI = certificat serveur HTTPS
ğŸŸ¢ MÃ‰THODE RECOMMANDÃ‰E (Red Hat Best Practice)
ğŸ‘‰ Garder la CA interne Satellite ğŸ‘‰ Remplacer UNIQUEMENT le certificat HTTPS du Web UI ğŸ‘‰ Capsules restent signÃ©es par Satellite (plus simple & supportÃ©)
1ï¸âƒ£ VÃ©rifier le FQDN du Satellite (CRITIQUE)
Copy code
Bash
hostname -f
Exemple attendu :
Copy code

satellite-prod.example.com
âš ï¸ Le CN/SAN du certificat doit matcher exactement ce FQDN
2ï¸âƒ£ GÃ©nÃ©rer une CSR (Certificate Signing Request)
ğŸ“ RÃ©pertoire recommandÃ©
Copy code
Bash
mkdir -p /root/ssl
cd /root/ssl
âœï¸ CrÃ©er la CSR
Copy code
Bash
openssl req -new -newkey rsa:4096 -nodes \
-keyout satellite.key \
-out satellite.csr
Renseigner :
Copy code

Common Name (CN) = satellite-prod.example.com
Organization = YourCompany
Country = FR
ğŸ‘‰ Ajoutez SAN (OBLIGATOIRE avec navigateurs modernes) :
Copy code
Bash
openssl req -new -newkey rsa:4096 -nodes \
-keyout satellite.key \
-out satellite.csr \
-subj "/CN=satellite-prod.example.com" \
-addext "subjectAltName=DNS:satellite-prod.example.com"
3ï¸âƒ£ Faire signer la CSR par une AutoritÃ© de Confiance
Options valides :
âœ… PKI interne entreprise (recommandÃ©)
âœ… DigiCert / GlobalSign / Sectigo
âš ï¸ Let's Encrypt â†’ OK seulement si Internet autorisÃ©
âš ï¸ Ne PAS utiliser auto-signÃ© en prod
Vous recevez :
satellite.crt
intermediate.crt
rootCA.crt
4ï¸âƒ£ Installer le certificat HTTPS sur Satellite
ğŸ“ Copier les fichiers
Copy code
Bash
cp satellite.key /etc/pki/tls/private/
cp satellite.crt /etc/pki/tls/certs/
cp intermediate.crt /etc/pki/tls/certs/
ğŸ”— CrÃ©er la chaÃ®ne complÃ¨te
Copy code
Bash
cat satellite.crt intermediate.crt > /etc/pki/tls/certs/satellite-fullchain.crt
5ï¸âƒ£ Appliquer le certificat avec satellite-installer
Copy code
Bash
satellite-installer \
--foreman-server-ssl-cert /etc/pki/tls/certs/satellite-fullchain.crt \
--foreman-server-ssl-key /etc/pki/tls/private/satellite.key \
--foreman-server-ssl-ca /etc/pki/tls/certs/rootCA.crt
â±ï¸ DurÃ©e : 5â€“10 minutes
6ï¸âƒ£ VÃ©rification HTTPS Web UI
Copy code
Bash
curl -vk https://satellite-prod.example.com
Navigateur :
ğŸ”’ cadenas vert
Pas dâ€™erreur CN/SAN
ğŸ”µ CERTIFICATS SSL POUR LES CAPSULES
ğŸ‘‰ RÃˆGLE Dâ€™OR
NE PAS utiliser une CA externe pour les Capsules
â¡ï¸ Capsules doivent Ãªtre signÃ©es par la CA Satellite
7ï¸âƒ£ GÃ©nÃ©rer le certificat Capsule depuis Satellite
Sur le Satellite :
Copy code
Bash
capsule-certs-generate \
--capsule-fqdn capsule-prod.example.com \
--certs-tar /root/capsule-prod-certs.tar
8ï¸âƒ£ Installer les certificats sur la Capsule
Copier lâ€™archive :
Copy code
Bash
scp /root/capsule-prod-certs.tar root@capsule-prod:/root/
Sur la Capsule :
Copy code
Bash
tar xvf capsule-prod-certs.tar
Puis :
Copy code
Bash
satellite-installer \
--scenario capsule \
--certs-tar-file capsule-prod-certs.tar \
--foreman-proxy-register-in-foreman true \
--foreman-proxy-foreman-base-url https://satellite-prod.example.com
9ï¸âƒ£ VÃ©rifier la Capsule
Copy code
Bash
hammer capsule list
hammer capsule info --name capsule-prod.example.com
Statut attendu :
Copy code

Status: OK
Certificates: valid
ğŸ” Ports HTTPS obligatoires (sÃ©curitÃ©)
Flux
Port
Satellite Web UI
443
Capsule â‡„ Satellite
443
Clients â‡„ Capsule
443
Pulp
24816
ğŸŸ¡ Erreurs frÃ©quentes (Ã  Ã©viter)
âŒ Certificat sans SAN
âŒ CN â‰  hostname
âŒ Certificat Capsule signÃ© par CA externe
âŒ Modification manuelle Apache sans satellite-installer
âŒ Firewall bloquant 443 inter-sites
âœ… RÃ©sumÃ© Architecture SSL PRO
Composant
Certificat
Satellite Web UI
CA entreprise
Capsules
CA Satellite
Clients RHEL
CA Satellite
Support Red Hat
100% OK
ğŸ‘‰ Si tu veux
Je peux te fournir :
âœ”ï¸ Checklist sÃ©curitÃ© audit (banque / ISO / CIS)
âœ”ï¸ Script automatisÃ© Ansible SSL Satellite + Capsules
âœ”ï¸ ProcÃ©dure spÃ©ciale environnement DISCONNECTED
âœ”ï¸ Migration SSL sans downtime
Dis-moi ton type dâ€™environnement (Prod / Qualif / Disconnected / Internet) et je tâ€™adapte la procÃ©dure ğŸ‘Œ


Voici la procÃ©dure claire et correcte (niveau production / Satellite 6.17â€“6.18) pour mettre en place des certificats SSL/TLS sur Red Hat Satellite Web UI (HTTPS) et sur les Capsules, avec les bonnes pratiques Red Hat ğŸ”
ğŸ¯ Objectif
AccÃ¨s HTTPS sÃ©curisÃ© au Satellite Web UI
Communication SSL valide Satellite â‡„ Capsules â‡„ Clients
Ã‰viter les certificats auto-signÃ©s non reconnus
ConformitÃ© sÃ©curitÃ© (banque / prod / audit)
ğŸ§± Architecture SSL Red Hat Satellite (rappel)
Satellite = CA interne (par dÃ©faut)
Capsules = certificats signÃ©s par la CA Satellite
Clients = certificats hÃ´te + CA Satellite
Web UI = certificat serveur HTTPS
ğŸŸ¢ MÃ‰THODE RECOMMANDÃ‰E (Red Hat Best Practice)
ğŸ‘‰ Garder la CA interne Satellite ğŸ‘‰ Remplacer UNIQUEMENT le certificat HTTPS du Web UI ğŸ‘‰ Capsules restent signÃ©es par Satellite (plus simple & supportÃ©)
1ï¸âƒ£ VÃ©rifier le FQDN du Satellite (CRITIQUE)
Copy code
Bash
hostname -f
Exemple attendu :
Copy code

satellite-prod.example.com
âš ï¸ Le CN/SAN du certificat doit matcher exactement ce FQDN
2ï¸âƒ£ GÃ©nÃ©rer une CSR (Certificate Signing Request)
ğŸ“ RÃ©pertoire recommandÃ©
Copy code
Bash
mkdir -p /root/ssl
cd /root/ssl
âœï¸ CrÃ©er la CSR
Copy code
Bash
openssl req -new -newkey rsa:4096 -nodes \
-keyout satellite.key \
-out satellite.csr
Renseigner :
Copy code

Common Name (CN) = satellite-prod.example.com
Organization = YourCompany
Country = FR
ğŸ‘‰ Ajoutez SAN (OBLIGATOIRE avec navigateurs modernes) :
Copy code
Bash
openssl req -new -newkey rsa:4096 -nodes \
-keyout satellite.key \
-out satellite.csr \
-subj "/CN=satellite-prod.example.com" \
-addext "subjectAltName=DNS:satellite-prod.example.com"
3ï¸âƒ£ Faire signer la CSR par une AutoritÃ© de Confiance
Options valides :
âœ… PKI interne entreprise (recommandÃ©)
âœ… DigiCert / GlobalSign / Sectigo
âš ï¸ Let's Encrypt â†’ OK seulement si Internet autorisÃ©
âš ï¸ Ne PAS utiliser auto-signÃ© en prod
Vous recevez :
satellite.crt
intermediate.crt
rootCA.crt
4ï¸âƒ£ Installer le certificat HTTPS sur Satellite
ğŸ“ Copier les fichiers
Copy code
Bash
cp satellite.key /etc/pki/tls/private/
cp satellite.crt /etc/pki/tls/certs/
cp intermediate.crt /etc/pki/tls/certs/
ğŸ”— CrÃ©er la chaÃ®ne complÃ¨te
Copy code
Bash
cat satellite.crt intermediate.crt > /etc/pki/tls/certs/satellite-fullchain.crt
5ï¸âƒ£ Appliquer le certificat avec satellite-installer
Copy code
Bash
satellite-installer \
--foreman-server-ssl-cert /etc/pki/tls/certs/satellite-fullchain.crt \
--foreman-server-ssl-key /etc/pki/tls/private/satellite.key \
--foreman-server-ssl-ca /etc/pki/tls/certs/rootCA.crt
â±ï¸ DurÃ©e : 5â€“10 minutes
6ï¸âƒ£ VÃ©rification HTTPS Web UI
Copy code
Bash
curl -vk https://satellite-prod.example.com
Navigateur :
ğŸ”’ cadenas vert
Pas dâ€™erreur CN/SAN
ğŸ”µ CERTIFICATS SSL POUR LES CAPSULES
ğŸ‘‰ RÃˆGLE Dâ€™OR
NE PAS utiliser une CA externe pour les Capsules
â¡ï¸ Capsules doivent Ãªtre signÃ©es par la CA Satellite
7ï¸âƒ£ GÃ©nÃ©rer le certificat Capsule depuis Satellite
Sur le Satellite :
Copy code
Bash
capsule-certs-generate \
--capsule-fqdn capsule-prod.example.com \
--certs-tar /root/capsule-prod-certs.tar
8ï¸âƒ£ Installer les certificats sur la Capsule
Copier lâ€™archive :
Copy code
Bash
scp /root/capsule-prod-certs.tar root@capsule-prod:/root/
Sur la Capsule :
Copy code
Bash
tar xvf capsule-prod-certs.tar
Puis :
Copy code
Bash
satellite-installer \
--scenario capsule \
--certs-tar-file capsule-prod-certs.tar \
--foreman-proxy-register-in-foreman true \
--foreman-proxy-foreman-base-url https://satellite-prod.example.com
9ï¸âƒ£ VÃ©rifier la Capsule
Copy code
Bash
hammer capsule list
hammer capsule info --name capsule-prod.example.com
Statut attendu :
Copy code

Status: OK
Certificates: valid
ğŸ” Ports HTTPS obligatoires (sÃ©curitÃ©)
Flux
Port
Satellite Web UI
443
Capsule â‡„ Satellite
443
Clients â‡„ Capsule
443
Pulp
24816
ğŸŸ¡ Erreurs frÃ©quentes (Ã  Ã©viter)
âŒ Certificat sans SAN
âŒ CN â‰  hostname
âŒ Certificat Capsule signÃ© par CA externe
âŒ Modification manuelle Apache sans satellite-installer
âŒ Firewall bloquant 443 inter-sites
âœ… RÃ©sumÃ© Architecture SSL PRO
Composant
Certificat
Satellite Web UI
CA entreprise
Capsules
CA Satellite
Clients RHEL
CA Satellite
Support Red Hat
100% OK
ğŸ‘‰ Si tu veux
Je peux te fournir :
âœ”ï¸ Checklist sÃ©curitÃ© audit (banque / ISO / CIS)
âœ”ï¸ Script automatisÃ© Ansible SSL Satellite + Capsules
âœ”ï¸ ProcÃ©dure spÃ©ciale environnement DISCONNECTED
âœ”ï¸ Migration SSL sans downtime
Dis-moi ton type dâ€™environnement (Prod / Qualif / Disconnected / Internet) et je tâ€™adapte la procÃ©dure ğŸ‘Œ