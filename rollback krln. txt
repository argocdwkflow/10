Parfait ğŸ‘
Tu es sur RHEL 7 et tu as bien le kernel 3.10.0-1160.139.el7.x86_64 installÃ©.
Voici la procÃ©dure propre et sÃ»re pour revenir sur ce kernel prÃ©cis.
ğŸ¯ Objectif
ğŸ‘‰ DÃ©marrer le serveur avec kernel 3.10.0-1160.139.el7.x86_64
ğŸ‘‰ Sans supprimer les autres kernels
ğŸ‘‰ Compatible environnement cluster VCS
âš ï¸ PRÃ‰CAUTIONS AVANT REBOOT (CLUSTER VCS)
Sur le nÅ“ud concernÃ© (ex: xxxxx) :
Copy code
Bash
hagrp -offline ALL -sys xxxxxx
VÃ©rifie :
Copy code
Bash
hastatus -sum
ğŸ‘‰ Le nÅ“ud doit Ãªtre PASSIF / OFFLINE
1ï¸âƒ£ VÃ©rifier les entrÃ©es GRUB (important)
Copy code
Bash
grubby --info=ALL | egrep "index=|kernel="
Tu verras quelque chose comme :
Copy code

index=0 kernel=/boot/vmlinuz-3.10.0-1160.142.1.el7.x86_64
index=1 kernel=/boot/vmlinuz-3.10.0-1160.139.1.el7.x86_64
index=2 kernel=/boot/vmlinuz-3.10.0-1160.133.1.el7.x86_64
ğŸ‘‰ Note lâ€™index correspondant Ã  1160.139
(souvent index=1, mais vÃ©rifie)
2ï¸âƒ£ MÃ©thode RECOMMANDÃ‰E â€” Reboot UNE FOIS sur le kernel 139
ğŸ‘‰ Temporaire (1 reboot seulement)
Si le kernel 139 est index=1 :
Copy code
Bash
grub2-reboot 1
reboot
âœ” TrÃ¨s sÃ»r
âœ” Aucun changement permanent
3ï¸âƒ£ MÃ©thode PERMANENTE (si tu veux rester sur 139)
Copy code
Bash
grubby --set-default /boot/vmlinuz-3.10.0-1160.139.1.el7.x86_64
reboot
4ï¸âƒ£ VÃ©rifier aprÃ¨s reboot
Copy code
Bash
uname -r
RÃ©sultat attendu :
Copy code

3.10.0-1160.139.1.el7.x86_64
5ï¸âƒ£ RÃ©activer le cluster
Copy code
Bash
hagrp -unfreeze ALL -sys svv
Puis Ã©ventuellement :
Copy code
Bash
hagrp -online ALL -sys xxx
(selon ta procÃ©dure interne)
âŒ Ã€ NE PAS FAIRE
âŒ supprimer le kernel 142 avant validation
âŒ modifier /boot/grub2/grub.cfg Ã  la main
âŒ reboot sans offline VCS
ğŸ§  Pourquoi câ€™est pertinent dans ton cas MQ/VCS
Le kernel 1160.142 a introduit chez certains clients :
changements IPC (shm / sem)
timings diffÃ©rents
impacts MQ + VxVM + VCS
ğŸ‘‰ Revenir en 1160.139 est une excellente mesure de stabilisation
ğŸ§¾ RÃ©sumÃ© express
Action
Commande
Voir kernels
rpm -q kernel
Voir index
grubby --info=ALL
Boot 1 fois
grub2-reboot <index>
Boot permanent
grubby --set-default
VÃ©rifier
uname -r
Si tu veux, je peux aussi :
te dire quel kernel supprimer ensuite
tâ€™aider Ã  bloquer les futures mises Ã  jour kernel
faire un rollback propre sur les deux nÅ“uds
Dis-moi ğŸ‘
