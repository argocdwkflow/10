Les agents CI Azure DevOps hébergés sur des serveurs RHEL 8 rencontrent un blocage systématique lors de l’exécution des commandes Podman, notamment podman version et podman pull. L’analyse des logs montre que le processus se fige pendant la phase d’initialisation du runtime OCI (runc / crun), avant toute tentative de communication réseau ou d’accès à Artifactory. Aucun flux sortant n’est généré, ce qui permet d’exclure un problème réseau, proxy, TLS ou Artifactory.
La cause racine identifiée est l’injection globale de Dynatrace OneAgent via le mécanisme système /etc/ld.so.preload, qui force le chargement de la bibliothèque liboneagentproc.so dans tous les binaires dynamiquement liés. Sur RHEL 8, cette injection interfère avec des composants bas niveau du système (glibc, pthread, futex) utilisés par Podman et le runtime OCI lors de l’initialisation. Cette interaction provoque un deadlock silencieux du processus, sans erreur explicite, bloquant toute exécution ultérieure.
Ce comportement est spécifique à RHEL 8, qui utilise une stack utilisateur plus ancienne (glibc, OpenSSL 1.1.1, Podman 3/4, runtimes OCI plus anciens). Les agents CI sous RHEL 9 ne sont pas impactés, car ils bénéficient de bibliothèques et runtimes plus récents et compatibles avec l’instrumentation Dynatrace, notamment une meilleure gestion des hooks et des mécanismes de synchronisation.
Les tests de validation confirment l’analyse : la désactivation temporaire de /etc/ld.so.preload ou l’exclusion effective de Podman et du runtime OCI de l’injection Dynatrace permet un fonctionnement immédiat et stable de Podman. Les configurations locales via oneagent.conf seules sont insuffisantes, car le preload système s’applique avant toute prise en compte de la configuration Dynatrace.
La remédiation recommandée consiste à exclure Podman et les runtimes OCI de l’injection Dynatrace sur les agents CI RHEL 8, ou à migrer ces agents vers RHEL 9 afin d’éliminer définitivement cette incompatibilité.